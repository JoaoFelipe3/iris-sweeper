# Experimental!
I ~ "git: github.com/Marcos-cat/iris"

# State 0 is undiscovered, 1 is discovered, 2 is flagged.
# Mine count of -1 is death!!!!!
â”Œâ”€â•´Tile
  ~[State MineCount]
  
  GetTextureNum â† â¨¬(
    10
  | â—¿10-1MineCount
  | 11
  )âŠ¸State
â””â”€â•´

GenBoard â† (
  â†¯âŠŸ.16 0
  â¥â‚„â‚€(
    âœâŠ¡â‹…1 â¢â‹…(âŠŸâˆ©âš‚â‚â‚†)(
      âˆ¨âˆ¨âŠƒâŠƒğ„â‰âŠ¡(/Ã—âŠ¡ â–½Ã—âŠ¸â¤šâŠƒ(â‰¡/Ã—â‰¥0|â‰¡/Ã—<Â¤â–³:) +âŠ‚Aâ‚‚Câ‚‚Â¤)
    ) âŠŸâˆ©âš‚â‚â‚†
  )
  âŠ™â—Œ
  â‰TileâŠ¸Ã—â‚€â¥â‹…Â¯1âŸœ(â†˜Â¯âŸœâ†˜â‹¯3â¬š0â§ˆ(/+â™­)3_3)
)

â”Œâ”€â•´Game
  ~{Board NoClick State}
  
  New â† Â°âŠ¸Boardâ†¯16_16_2 0 Â°âŠ¸NoClick1{0 0 0}
  
  Discover â† |2 (
    â‰ 1Tile~Stateâ—¡(âŠ¡âŠ™Board)
    â¨¬â‹…âˆ˜(
      â¥(âŠ™â–¡â‚ƒğ„âŸœâŠ“GenBoardâ‹…0 âŠ™Â°â–¡â‚ƒ) NoClick,
      âŸœâœ(Tile~StateâŠ¡âŠ™Board)â‹…1
      Tile~MineCountâ—¡(âŠ¡âŠ™Board)
      â£(âˆ§Discover â–½Ã—â—¡âŠƒ(â‰¡/Ã—â‰¥0|â‰¡/Ã—<Â¤â†™â‚‚â–³Board:) +âŠ‚Aâ‚‚Câ‚‚Â¤ Â°0
      | âœBoardâ‰¡â‚‚(â¥âœTile~Stateâ‹…1=Â¯1âŠ¸Tile~MineCount) âœStateâ‹…Â¯1 â—ŒÂ°Â¯1
      | â‹…â‹…âˆ˜)
    )
  )
  Flag â† âœ(Tile~StateâŠ¡âŠ™Board|â¥âœÃ·â‚‚Â¬â‰ 1.)
  
  CheckWin â† âœâŠ™StateâŠ™â—Œ /Ã—â™­â‰¡â‚‚(âˆ¨âŠƒ(=1Tile~State|=Â¯1Tile~MineCount))âŠ¸Board
  
  Draw â† (
    âŸœ(â‡¡â†™2â–³) Board
    â‰¡â‚‚(
      âŠŸâŒŠâŠƒÃ·â—¿4Tile~GetTextureNum
      âœâŠ¢â‡Œâˆ©(âŠŸ:âŠŸ.16)âŠ™âœâŠ£+â‚ƒâ‚€âˆ©Ã—â‚â‚†
      I~Texture~Map âŠ™âŠ™âŠƒâŠƒ0_0 0 Â°â—Œ
    )
  )
â””â”€â•´

PixelToTile â† âŒŠÃ·16âŠŸâŠ™-â‚ƒâ‚€Â°â„‚

Text â† map 0_1_Â¯1 {"16x16, 40 mines" "You win!" "You lose..."}

I~Open 256_286 "Minesweeper"

Game~New

â¬š(I~Texture~Load "assets/tiles.png")I~Loop!(
  I~Draw~Backgroundâ†¯3 0.5
  I~Draw~Text White 30 0_0 getâŠ™TextâŠ¸Game~State
  â¥(
    Game~CheckWin
    Mouse!Pressedâ€¼Left(â¥Game~Discover/Ã—â‰¥0.PixelToTile)
    Mouse!Pressedâ€¼Right(â¥Game~Flag/Ã—â‰¥0.PixelToTile)
  )=0âŠ¸Game~State
  âŠ¸Game~Draw
)
